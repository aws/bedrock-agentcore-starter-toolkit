import os
from langchain_mcp_adapters.client import MultiServerMCPClient

# Define the inbound authentication mechanism for AgentCore Gateway - AWS IAM or JWT
# https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/gateway-inbound-auth.html
def get_bearer_auth():
    """
    Defines Inbound Authentication for AgentCore Gateway
    """
    raise NotImplementedError()

def get_streamable_http_mcp_client() -> MultiServerMCPClient:
    gateway_url = os.getenv("gatewayUrl")
    if not gateway_url:
        raise RuntimeError("Missing required environment variable: gatewayUrl")
    return MultiServerMCPClient(
        {
            "agentcore_gateway": {
                "transport": "streamable_http",
                "url": f"{gateway_url}/mcp",
                "headers": {
                    "Authorization": f"Bearer {get_bearer_auth()}"
                }
            }
        }
    )